{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "description": "user preferences for a subscriber",
    "required": [],
    "properties": {
        "attribute": { "type": "string", "description": "The preference name." },
        "value": { "type": "string", "description": "The preference name." },
    },
    "title": "subscriberpreference",
    "type": "object"
}

[% #
GET /api/subscriberpreferences/?subscriber_id=10

[
	"cli": "12345",
	"block_in_list": [ "12345", "12346", "12347" ]
]

POST /api/subscriberpreferences/?subscriber_id=10
[
	"cli": "12345",
	"block_in_list": [ "12345", "12346", "12347" ]
]

GET /api/subscribers/?id=77

{
	"username": "foo",

	"_links": [
		"callforwards": {
			"href": "/api/callforwards/?subscriber_id=987"
		},

		"cf_destinationsets": {
			"href": "/api/destinationsets/?subscriber_id=987"
		}
	],
}

GET /api/callforwards/?subscriber_id=77

{

	# should be separated by cf types
	"_links": [
		"cfu": {
			"href": "/api/callforwards/?id=555"
		}
		"cfb": {
			"href": "/api/callforwards/?id=556"
		}
	]
}

GET /api/callforwards/?id=555

{
	"_links": [
		"destinationset": {
			"href": "/api/cf_destinationsets/?id=555"
		},
		"timeset": {
			"href": "/api/cf_timesets/?id=556"
		},
	]
}




GET /api/destinationsets/?subscriber_id=77

PATCH /api/subscribers/?id=77

[
	{ "op": 
	
]


$res = $ua->get("/api/subscribers/?id=77")->from_json;
$cf = $res->{_links}->{callforwards}; # "/api/callforwards/?subscriber_id=77
$dsets = $res->{_links}->{cf_destinationsets}; # "/api/cf_destinationsets/?subscriber_id=77
$res = $ua->get($cf->{href})->from_json;
$cfu = $res->{_links}->{cfu}; # /api/callforwards/?id=555
if($cfu) {
	$res = $ua->get($cfu)->from_json;
	$res = $ua->get($res->{_links}->{collection}->{href})->from_json;
	$dset = $res->{_links}->{destinationsets}->[0];

	$ua->put($cfu->{href}, "{ \"_links\": [ \"destinationset\": { \"href\": \"$dset->{href}\" }, \"timeset\": null] }");
} else {
	$res = $ua->get($dsets->{href})->from_json;
	$dset = $res->{_links}->{destinationsets}->[0];

	$ua->put($cf->{href}, "{ \"_links\": [ \"destinationset\": { \"href\": \"$dset->{href}\" }, \"timeset\": null] }");
}

-%]
